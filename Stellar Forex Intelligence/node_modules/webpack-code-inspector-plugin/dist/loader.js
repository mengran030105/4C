"use strict";var d=(t,e,s)=>new Promise((p,a)=>{var l=i=>{try{n(s.next(i))}catch(c){a(c)}},f=i=>{try{n(s.throw(i))}catch(c){a(c)}},n=i=>i.done?p(i.value):Promise.resolve(i.value).then(l,f);n((s=s.apply(t,e)).next())});const r=require("code-inspector-core"),y=["isJsx","isTsx","lang.jsx","lang.tsx"];function S(t){return d(this,null,function*(){var h,g;this.cacheable&&this.cacheable(!0);let e=r.normalizePath(this.resourcePath),s=new URLSearchParams(this.resource);const p=this.query,{escapeTags:a=[],mappings:l}=p||{};if(e=r.getMappingFilePath(e,l),r.isJsTypeFile(e)||e.endsWith(".vue")&&y.some(o=>s.get(o)!==null))return r.transformCode({content:t,filePath:e,fileType:"jsx",escapeTags:a});if(e.endsWith(".vue")&&(s.get("lang")==="tsx"||s.get("lang")==="jsx")){const{descriptor:o}=r.parseSFC(t,{sourceMap:!1}),x=[(h=o.script)==null?void 0:h.content,(g=o.scriptSetup)==null?void 0:g.content];for(const u of x){if(!u)continue;const m=r.transformCode({content:u,filePath:e,fileType:"jsx",escapeTags:a});t=t.replace(u,m)}return t}return e.endsWith(".vue")&&s.get("type")!=="style"&&s.get("type")!=="script"&&s.get("raw")===null?r.transformCode({content:t,filePath:e,fileType:"vue",escapeTags:a}):e.endsWith(".svelte")?r.transformCode({content:t,filePath:e,fileType:"svelte",escapeTags:a}):t})}module.exports=S;
