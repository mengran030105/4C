var pe=Object.defineProperty;var X=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var ee=(t,e,a)=>e in t?pe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,b=(t,e)=>{for(var a in e||(e={}))ve.call(e,a)&&ee(t,a,e[a]);if(X)for(var a of X(e))me.call(e,a)&&ee(t,a,e[a]);return t};var te=(t,e,a)=>new Promise((n,l)=>{var o=s=>{try{p(a.next(s))}catch(v){l(v)}},u=s=>{try{p(a.throw(s))}catch(v){l(v)}},p=s=>s.done?n(s.value):Promise.resolve(s.value).then(o,u);p((a=a.apply(t,e)).next())});import{d as U,m as fe,s as G,p as j,t as he,c as V,q as _e,v as I,x as le,o as W,y as oe,n as ge,z as De,A as Z,b as S,e as y,h as f,_ as J,r as h,B as we,C as xe,u as be,E as N,a as ye,D as Oe,f as w,k as q,w as F,F as Ee,j as Ce,i as Y,G as Te,l as Se}from"./index-CQEFTnR1.js";import{i as re,t as Me,u as Ae,a as ke,b as Ve,c as Ie,d as Re,e as $e}from"./index-Ckr1lvBC.js";import{C as Le}from"./country-name-zh-mapping-CVShLKuS.js";const Ne=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function Pe(t){function e(n){return(...l)=>{if(!t.value)throw new Error("ECharts is not initialized yet.");return t.value[n].apply(t.value,l)}}function a(){const n=Object.create(null);return Ne.forEach(l=>{n[l]=e(l)}),n}return a()}function Ue(t,e,a){I([a,t,e],([n,l,o],u,p)=>{let s=null;if(n&&l&&o){const{offsetWidth:v,offsetHeight:D}=n,O=o===!0?{}:o,{throttle:m=100,onResize:_}=O;let M=!1;const A=()=>{l.resize(),_==null||_()},E=m?Me(A,m):A;s=new ResizeObserver(()=>{!M&&(M=!0,n.offsetWidth===v&&n.offsetHeight===D)||E()}),s.observe(n)}p(()=>{s&&(s.disconnect(),s=null)})})}const ze={autoresize:[Boolean,Object]},Fe=/^on[^a-z]/,ie=t=>Fe.test(t);function Ye(t){const e={};for(const a in t)ie(a)||(e[a]=t[a]);return e}function B(t,e){const a=De(t)?Z(t):t;return a&&typeof a=="object"&&"value"in a?a.value||e:a||e}const je="ecLoadingOptions";function Be(t,e,a){const n=j(je,{}),l=V(()=>b(b({},B(n,{})),a==null?void 0:a.value));le(()=>{const o=t.value;o&&(e.value?o.showLoading(l.value):o.hideLoading())})}const He={loading:Boolean,loadingOptions:Object};let P=null;const ce="x-vue-echarts";function Ke(){if(P!=null)return P;if(typeof HTMLElement=="undefined"||typeof customElements=="undefined")return P=!1;try{new Function("tag","class EChartsElement extends HTMLElement{__dispose=null;disconnectedCallback(){this.__dispose&&(this.__dispose(),this.__dispose=null)}}customElements.get(tag)==null&&customElements.define(tag,EChartsElement);")(ce)}catch(t){return P=!1}return P=!0}document.head.appendChild(document.createElement("style")).textContent=`x-vue-echarts{display:block;width:100%;height:100%;min-width:0}
`;const Ge=Ke(),qe="ecTheme",We="ecInitOptions",Ze="ecUpdateOptions",ae=/(^&?~?!?)native:/;var Je=U({name:"echarts",props:b(b({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},ze),He),emits:{},inheritAttrs:!1,setup(t,{attrs:e}){const a=G(),n=G(),l=G(),o=j(qe,null),u=j(We,null),p=j(Ze,null),{autoresize:s,manualUpdate:v,loading:D,loadingOptions:O}=he(t),m=V(()=>l.value||t.option||null),_=V(()=>t.theme||B(o,{})),M=V(()=>t.initOptions||B(u,{})),A=V(()=>t.updateOptions||B(p,{})),E=V(()=>Ye(e)),r={},c=_e().proxy.$listeners,x={};c?Object.keys(c).forEach(d=>{ae.test(d)?r[d.replace(ae,"$1")]=c[d]:x[d]=c[d]}):Object.keys(e).filter(d=>ie(d)).forEach(d=>{let i=d.charAt(2).toLowerCase()+d.slice(3);if(i.indexOf("native:")===0){const $=`on${i.charAt(7).toUpperCase()}${i.slice(8)}`;r[$]=e[d];return}i.substring(i.length-4)==="Once"&&(i=`~${i.substring(0,i.length-4)}`),x[i]=e[d]});function k(d){if(!a.value)return;const i=n.value=re(a.value,_.value,M.value);t.group&&(i.group=t.group),Object.keys(x).forEach(L=>{let C=x[L];if(!C)return;let T=L.toLowerCase();T.charAt(0)==="~"&&(T=T.substring(1),C.__once__=!0);let K=i;if(T.indexOf("zr:")===0&&(K=i.getZr(),T=T.substring(3)),C.__once__){delete C.__once__;const ue=C;C=(...de)=>{ue(...de),K.off(T,C)}}K.on(T,C)});function $(){i&&!i.isDisposed()&&i.resize()}function Q(){const L=d||m.value;L&&i.setOption(L,A.value)}s.value?ge(()=>{$(),Q()}):Q()}function H(d,i){t.manualUpdate&&(l.value=d),n.value?n.value.setOption(d,i||{}):k(d)}function R(){n.value&&(n.value.dispose(),n.value=void 0)}let g=null;I(v,d=>{typeof g=="function"&&(g(),g=null),d||(g=I(()=>t.option,(i,$)=>{i&&(n.value?n.value.setOption(i,b({notMerge:i!==$},A.value)):k())},{deep:!0}))},{immediate:!0}),I([_,M],()=>{R(),k()},{deep:!0}),le(()=>{t.group&&n.value&&(n.value.group=t.group)});const z=Pe(n);return Be(n,D,O),Ue(n,s,a),W(()=>{k()}),oe(()=>{Ge&&a.value?a.value.__dispose=R:R()}),b({chart:n,root:a,setOption:H,nonEventAttrs:E,nativeListeners:r},z)},render(){const t=b(b({},this.nonEventAttrs),this.nativeListeners);return t.ref="root",t.class=t.class?["echarts"].concat(t.class):"echarts",fe(ce,t)}});const Qe={class:"chart-container"},Xe=U({__name:"RiskChart",props:{chartData:{},title:{}},setup(t){Ae([ke,Ve,Ie,Re,$e]);const e=t,a=V(()=>{const n=e.chartData.values||[],l=Math.max(...n)*1.1,o=Math.min(...n)*.9;return{title:{text:e.title,left:"center"},tooltip:{trigger:"axis",formatter:u=>{const{name:p,value:s}=u[0];return`时间: ${p} <br> 值: ${s}`}},xAxis:{type:"category",data:e.chartData.time||[],boundaryGap:!1},yAxis:{type:"value",min:parseFloat(o.toFixed(2)),max:parseFloat(l.toFixed(2))},series:[{name:"风险信号",type:"line",data:e.chartData.values||[],smooth:!0,lineStyle:{width:2}}]}});return(n,l)=>(y(),S("div",Qe,[f(Z(Je),{class:"chart",option:a.value,autoresize:""},null,8,["option"])]))}}),ne=J(Xe,[["__scopeId","data-v-840cbd8b"]]),et={class:"calendar-container"},tt=U({__name:"CollapsibleCalendar",emits:["dateRangeSelected"],setup(t,{emit:e}){const a=h([new Date("2024-12-01"),new Date("2024-12-07")]),n=h(a.value),l=e;I(n,u=>{u&&u.length===2&&l("dateRangeSelected",u)});const o=u=>u.getFullYear()!==2024;return(u,p)=>(y(),S("div",et,[f(Z(we),{modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=s=>n.value=s),type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","default-value":a.value,disabledDate:o},null,8,["modelValue","default-value"])]))}}),at=J(tt,[["__scopeId","data-v-f6d6d100"]]),se=U({__name:"DrawDownChart",props:{chartData:{},maxDrawdown:{},title:{}},setup(t){const e=t,a=h(null);let n=null;const l=()=>{n&&(n.dispose(),n=null)},o=()=>{if(!a.value)return;if(l(),n=re(a.value),!e.chartData||!e.chartData.time||!e.chartData.values){console.warn("图表数据为空");return}const u=[];for(let s=0;s<e.chartData.values.length-1;s++){const v=e.chartData.values[s],D=e.chartData.values[s+1],O=e.chartData.time[s],m=e.chartData.time[s+1],_=e.maxDrawdown!==void 0&&(v>e.maxDrawdown||D>e.maxDrawdown);u.push({data:[{name:O,value:[O,v]},{name:m,value:[m,D]}],lineStyle:{color:_?"#FF0000":"#5470C6"}})}const p={title:{text:e.title,left:"center"},xAxis:{type:"category",data:e.chartData.time},yAxis:{type:"value"},tooltip:{trigger:"axis",formatter:s=>{const v=s[0];return`
          <div>
            <strong>时间：</strong>${v.name}<br/>
            <strong>值：</strong>${v.value[1].toFixed(2)}<br/>
          </div>
        `}},series:u.map(s=>({type:"line",data:s.data,lineStyle:s.lineStyle,showSymbol:!1})),markLine:e.maxDrawdown!==void 0?{data:[{yAxis:e.maxDrawdown,lineStyle:{color:"#FF0000",width:2},label:{show:!0,formatter:"最大回撤比例"}}]}:void 0};n.setOption(p)};return W(()=>{o()}),oe(()=>{l()}),I(()=>[e.chartData,e.maxDrawdown],()=>{o()},{deep:!0}),(u,p)=>(y(),S("div",{ref_key:"chart",ref:a,style:{width:"100%",height:"400px"}},null,512))}}),nt={style:{display:"block"}},st={key:0,class:"custom-message-container"},lt={style:{display:"flex",width:"100%","align-items":"center"}},ot={class:"selection"},rt={class:"up"},it={class:"down"},ct={class:"chart_container"},ut={class:"chart_container"},dt={class:"report_container"},pt={key:0,class:"report_content"},vt={key:1,class:"report_empty"},mt=U({__name:"404",setup(t){const e=be(),a=h(!0),n=()=>{a.value=!1};setTimeout(()=>{n()},1e4);const l=h([]),o=h([new Date("2024-12-01"),new Date("2024-12-07")]),u=h({time:[],values:[]}),p=h({time:[],values:[]}),s=h({time:[],values:[]}),v=h({time:[],values:[]}),D=h(""),O=h(Le),m=h(2),_=h(5);W(()=>{xe.alert("本页面需生成报告，加载时间较长，请耐心等待","提示",{confirmButtonText:"确定",callback:()=>{}});const r=e.currentRoute.value.query;if(r.countries){const c=r.countries.toString().split(",");l.value=c,E()}});const M=r=>{o.value=[new Date(r[0]),new Date(r[1])],E()},A=()=>{E()},E=()=>te(this,null,function*(){if(o.value[0].toISOString().split("T")[0],o.value[1].toISOString().split("T")[0],l.value.length!==2){N.warning("请选择两个国家");return}if(m.value===null||m.value<=0){N.warning("请输入有效的最大回撤比例");return}if(_.value===null){N.warning("请选择交易期限");return}if(!o.value||!o.value[0]||!o.value[1]){N.warning("请选择有效的日期范围");return}if(!(o.value[0]instanceof Date)||!(o.value[1]instanceof Date)){N.warning("日期格式无效");return}try{const r=yield ye.post("http://121.36.9.36:8000/currency_pair/",{countries:l.value,startDate:o.value[0].toISOString().split("T")[0],endDate:o.value[1].toISOString().split("T")[0],maxDrawdown:m.value,investmentPeriod:_.value});u.value={time:r.data.data.date_time,values:r.data.data.predict_rate.map(Number)},p.value={time:r.data.data.date_time,values:r.data.data.true_rate.map(Number)},s.value={time:r.data.data.date_time,values:r.data.data.maxdd_predict.map(Number)},v.value={time:r.data.data.date_time,values:r.data.data.maxdd_true.map(Number)},r.data.data.ai_result?D.value=r.data.data.ai_result:D.value="未找到报告内容"}catch(r){console.error("请求失败:",r)}});return I([l,o],()=>{l.value.length===2&&o.value&&E()}),(r,c)=>{const x=Y("el-option"),k=Y("el-select"),H=Y("el-input"),R=Y("el-button");return y(),S("div",nt,[a.value?(y(),S("div",st,[w("div",{class:"custom-message"},[c[3]||(c[3]=q(" 若页面长时间未响应，请退出系统重新登陆！ ")),w("i",{class:"el-icon-close",onClick:n})])])):Oe("",!0),w("div",lt,[w("div",ot,[w("div",rt,[f(at,{class:"select_calendar",onDateRangeSelected:M}),f(k,{modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=g=>l.value=g),multiple:"",placeholder:"请选择国家",class:"select_country"},{default:F(()=>[(y(!0),S(Ee,null,Ce(O.value,(g,z)=>(y(),Se(x,{key:z,label:g,value:z,class:"select_country"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),w("div",it,[f(H,{modelValue:m.value,"onUpdate:modelValue":c[1]||(c[1]=g=>m.value=g),modelModifiers:{number:!0},type:"number",placeholder:"请输入最大回撤比例",class:"drawdown-input",step:.01},{append:F(()=>c[4]||(c[4]=[q("%")])),_:1},8,["modelValue"]),f(k,{modelValue:_.value,"onUpdate:modelValue":c[2]||(c[2]=g=>_.value=g),placeholder:"选择交易期限",class:"period-select"},{default:F(()=>[f(x,{label:"5年",value:5}),f(x,{label:"3年",value:3}),f(x,{label:"1年",value:1})]),_:1},8,["modelValue"])])]),f(R,{class:"button",onClick:A},{default:F(()=>c[5]||(c[5]=[q(" 更新国家 ")])),_:1})]),w("div",ct,[f(ne,{class:"chart1",chartData:u.value,title:"预测汇率波动图"},null,8,["chartData"]),f(ne,{class:"chart2",chartData:p.value,title:"真实汇率波动图"},null,8,["chartData"])]),w("div",ut,[f(se,{class:"chart1",chartData:s.value,title:"预测风险信号图",maxDrawdown:m.value},null,8,["chartData","maxDrawdown"]),f(se,{class:"chart2",chartData:v.value,title:"真实风险信号图",maxDrawdown:m.value},null,8,["chartData","maxDrawdown"])]),w("div",dt,[c[6]||(c[6]=w("div",{class:"report_title"},"分析报告",-1)),D.value?(y(),S("div",pt,Te(D.value),1)):(y(),S("div",vt,"暂无报告数据"))])])}}}),Dt=J(mt,[["__scopeId","data-v-5d893f49"]]);export{Dt as default};
